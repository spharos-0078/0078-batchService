# ⚙️ Batch Service

> **배치 처리 서비스** - 스케줄링 기반 데이터 집계 및 통계 처리를 담당하는 서비스

## 📋 목차

- [프로젝트 개요](#-프로젝트-개요)
- [기술 스택](#-기술-스택)
- [주요 기능](#-주요-기능)
- [배치 작업](#-배치-작업)
- [환경 설정](#-환경-설정)
- [실행 방법](#-실행-방법)
- [API 문서](#-api-문서)
- [팀원 정보](#-팀원-정보)

## 🎯 프로젝트 개요

Batch Service는 **정기적인 데이터 처리**와 **통계 집계**를 담당하는 서비스로, 대용량 데이터를 효율적으로 처리합니다.

### 핵심 기능
- **차트 데이터 집계**: 분/일/월/연단위 가격 데이터 집계
- **베스트 상품 집계**: 인기 상품 순위 계산
- **사용자 자산 통계**: 사용자별 자산 현황 집계
- **시장 데이터 분석**: 시장 동향 분석 및 지표 계산

### 처리 방식
- **스케줄링 기반**: 정기적인 자동 실행
- **배치 처리**: 대용량 데이터 효율적 처리
- **병렬 처리**: 멀티 스레드 기반 성능 최적화
- **장애 복구**: 실패 시 자동 재시도

## 🛠️ 기술 스택

### Backend
- **Java 17** - LTS 버전
- **Spring Boot 3.5.0** - 최신 프레임워크
- **Spring Batch 5.0** - 배치 처리 프레임워크
- **Spring Scheduling** - 스케줄링 기능
- **Spring Web** - REST API

### Service Communication
- **OpenFeign** - 서비스 간 HTTP 통신
- **Netflix Eureka** - 서비스 디스커버리

### Documentation
- **SpringDoc OpenAPI 3** - API 문서화
- **Swagger UI** - API 테스트

## 🚀 주요 기능

### 1. 차트 데이터 집계
- **분봉 데이터**: 1분 단위 가격 데이터 집계
- **일봉 데이터**: 일별 OHLC 데이터 생성
- **주봉 데이터**: 주별 가격 데이터 집계
- **월봉 데이터**: 월별 가격 데이터 집계

### 2. 베스트 상품 집계
- **인기 상품**: 거래량 기준 인기 상품 선정
- **수익률 랭킹**: 수익률 기준 상품 순위
- **신규 상품**: 신규 등록 상품 집계
- **카테고리별 랭킹**: 카테고리별 인기 상품

### 3. 사용자 자산 통계
- **총 자산**: 사용자별 총 자산 계산
- **수익률**: 개별 상품 및 전체 수익률
- **포트폴리오 분석**: 자산 분배 비율 분석
- **거래 통계**: 거래 횟수, 거래 금액 집계

### 4. 시장 데이터 분석
- **시장 지수**: 전체 시장 동향 지수 계산
- **거래량 분석**: 일별/시간대별 거래량 분석
- **변동성 지수**: 가격 변동성 지수 계산
- **트렌드 분석**: 상승/하락 추세 분석

## 📊 배치 작업

### 작업 스케줄 (KST 기준)
- **매분**: 실시간 데이터 동기화
- **매시간**: 시간별 집계 데이터 생성
- **매일 01:00**: 일별 집계 데이터 생성
- **매일 02:00**: 베스트 상품 집계
- **매일 03:00**: 사용자 자산 통계
- **매주 월요일 04:00**: 주간 집계 데이터 생성
- **매월 1일 05:00**: 월간 집계 데이터 생성

### 배치 작업 관리
- **작업 실행**: 스케줄에 따른 자동 실행
- **상태 모니터링**: 작업 진행 상태 추적
- **실패 처리**: 실패 시 자동 재시도
- **성능 최적화**: 병렬 처리 및 청크 단위 처리

## ⚙️ 환경 설정

### 필수 요구사항
- Java 17 이상
- 충분한 메모리 (최소 2GB 권장)
- 데이터베이스 연결 (대용량 처리용)
- Eureka Server 실행 중

### 환경 변수
- **BATCH_CHUNK_SIZE**: 배치 처리 청크 크기
- **BATCH_THREAD_COUNT**: 병렬 처리 스레드 수
- **EUREKA_CLIENT_SERVICE_URL**: Eureka 서버 정보
- **SPRING_PROFILES_ACTIVE**: 실행 환경 프로파일

## 🚀 실행 방법

### 1. 저장소 클론
프로젝트 저장소를 로컬에 클론합니다.

### 2. 환경 변수 설정
필요한 환경 변수를 설정합니다.

### 3. 애플리케이션 실행
Gradle을 통해 애플리케이션을 실행합니다.

### 4. 접속 확인
- API 엔드포인트: http://localhost:8094
- Swagger UI: http://localhost:8094/swagger-ui/index.html

## 📚 API 문서

### Swagger UI 접속
API 문서는 Swagger UI를 통해 확인할 수 있습니다.

### 주요 API 엔드포인트

#### 배치 작업 관리
- **배치 작업 수동 실행**: 특정 배치 작업을 수동으로 실행
- **배치 작업 목록 조회**: 전체 배치 작업 목록 조회
- **배치 작업 상세 조회**: 특정 배치 작업 상세 정보 조회
- **배치 작업 실행 상태**: 배치 작업의 현재 실행 상태 확인

#### 집계 데이터 조회
- **차트 데이터 조회**: 차트용 집계 데이터 조회
- **베스트 상품 조회**: 인기 상품 순위 조회
- **사용자 통계 조회**: 사용자별 자산 통계 조회
- **시장 통계 조회**: 전체 시장 통계 조회

#### 작업 스케줄 관리
- **스케줄 목록 조회**: 등록된 스케줄 목록 조회
- **스케줄 일시정지**: 특정 스케줄 일시정지
- **스케줄 재시작**: 일시정지된 스케줄 재시작

## 🔧 주요 설정

### 배치 처리 설정
Spring Batch를 통한 대용량 데이터 처리가 최적화되어 있습니다.

### 스케줄링 설정
Spring Scheduling을 통한 정기적인 작업 실행이 설정되어 있습니다.

### 성능 최적화 설정
멀티 스레드 처리와 청크 단위 처리로 성능이 최적화되어 있습니다.

## 👥 팀원 정보

**Piece of Cake 팀**
- **팀장**: 이수진 (Backend & Leader)
- **팀원**: 정동섭 (Backend), 이영인 (Backend), 오은서 (Backend), 정진우 (Frontend)

**Batch Service 담당**
- **이수진**: 배치 처리 시스템, 데이터 집계, 스케줄링

---

## 📞 연락처

- **프로젝트 홈페이지**: https://mobile.pieceofcake.site/
- **개발 기간**: 2025년 4월 30일 ~ 7월 10일

---

*"Investment is Easy and Fun" - Piece of Cake 프로젝트* 
